12.11.2025:

waveform dataset settings

domain:
  type: UniformFrequencyDomain
  f_min: 20.0
  f_max: 256.0
  delta_f: 0.125  # Expressions like 1.0/8.0 would require eval and are not supported

waveform_generator:
  approximant: IMRPhenomXPHM  # SEOBNRv4PHM
  f_ref: 20.0
  # f_start: 15.0  # Optional setting useful for EOB waveforms. Overrides f_min when generating waveforms.
  spin_conversion_phase: 0.0

# Dataset only samples over intrinsic parameters. Extrinsic parameters are chosen at train time.
intrinsic_prior:
  mass_1: bilby.core.prior.Constraint(minimum=10.0, maximum=120.0, name='mass_1')
  mass_2: bilby.core.prior.Constraint(minimum=10.0, maximum=120.0, name='mass_2')
  chirp_mass: bilby.gw.prior.UniformInComponentsChirpMass(minimum=15.0, maximum=150.0, name='chirp_mass')
  mass_ratio: bilby.gw.prior.UniformInComponentsMassRatio(minimum=0.125, maximum=1.0, name='mass_ratio')
  phase: default
  chi_1: bilby.gw.prior.AlignedSpin(name='chi_1', a_prior=Uniform(minimum=0, maximum=0.9))
  chi_2: bilby.gw.prior.AlignedSpin(name='chi_2', a_prior=Uniform(minimum=0, maximum=0.9))
  theta_jn: default
  # Reference values for fixed (extrinsic) parameters. These are needed to generate a waveform.
  luminosity_distance: 100.0  # Mpc
  geocent_time: 0.0  # s

# Dataset size
num_samples: 10000

# Save a compressed representation of the dataset
compression:
  svd:
    # Truncate the SVD basis at this size. No truncation if zero.
    size: 50
    num_training_samples: 5000
    num_validation_samples: 1000
  whitening: aLIGO_ZERO_DET_high_P_asd.txt



Max mismatch svd size 50 = 0.0156
Max mismatch svd size 100= 0.0139 @90s
Max mismatch svs size 200= 0.0048 @120s



3.12.2025:
domain:
  type: UniformFrequencyDomain
  f_min: 20.0
  f_max: 1024.0
  delta_f: 0.5  # Expressions like 1.0/8.0 would require eval and are not supported
 

waveform_generator:
  approximant: IMRPhenomXPHM  # SEOBNRv4PHM
  f_ref: 20.0
  # f_start: 15.0  # Optional setting useful for EOB waveforms. Overrides f_min when generating waveforms.
  spin_conversion_phase: 0.0

# Dataset only samples over intrinsic parameters. Extrinsic parameters are chosen at train time.
intrinsic_prior:
  mass_1: bilby.core.prior.Constraint(minimum=50.0, maximum=100.0, name='mass_1')
  mass_2: bilby.core.prior.Constraint(minimum=50.0, maximum=100.0, name='mass_2')
  chirp_mass: bilby.gw.prior.UniformInComponentsChirpMass(minimum=43.0, maximum=88.0, name='chirp_mass')
  mass_ratio: bilby.gw.prior.UniformInComponentsMassRatio(minimum=0.5, maximum=1.0, name='mass_ratio')
  phase: default
  chi_1: bilby.gw.prior.AlignedSpin(name='chi_1', a_prior=Uniform(minimum=0, maximum=0.9))
  chi_2: bilby.gw.prior.AlignedSpin(name='chi_2', a_prior=Uniform(minimum=0, maximum=0.9))
  theta_jn: default
  # Reference values for fixed (extrinsic) parameters. These are needed to generate a waveform.
  luminosity_distance: 1000.0  # Mpc
  geocent_time: 0.0  # s

# Dataset size
num_samples: 10000  #for production use arround 5000000

# Save a compressed representation of the dataset
compression:
  svd:
    # Truncate the SVD basis at this size. No truncation if zero.
    size: 200
    num_training_samples: 5000
    num_validation_samples: 1000
  whitening: aLIGO_ZERO_DET_high_P_asd.txt

Max mismatch = 4.463958164224735e-06 @1m37s

First ASD set 2m17s
second ASD set 14m30s

No gpu usage for above cases....

5.12.2025:

Batch size has to be reduced from 4096 to 512 due to ram limitation 8gb
512 uses 7.5 gb, gpu usage during trainging lower than 70%
memory overflow in training epoch... 35m15s

reducing batch size to 256
forgot to adjust learning rate....

memory usage can also be reduced with hidden dimensions
=> batch size 1024, hidden dim halved to 512
memory usage arround 6gb
trained in under 20 minimum

for inference correct ram has to be specified in ini file
set num of samples and batch size to 5000s


15.12.2025

Use aproptiate priors!!!!

16.12.2025

new waveform dataset similar to toy model
generation time 3m40s

#########################################################
domain:
  type: UniformFrequencyDomain
  f_min: 20.0
  f_max: 1024.0
  delta_f: 0.25  # Expressions like 1.0/8.0 would require eval and are not supported
 

waveform_generator:
  approximant: IMRPhenomXPHM  # SEOBNRv4PHM
  f_ref: 20.0
  # f_start: 15.0  # Optional setting useful for EOB waveforms. Overrides f_min when generating waveforms.
  spin_conversion_phase: 0.0

# Dataset only samples over intrinsic parameters. Extrinsic parameters are chosen at train time.
intrinsic_prior:
  mass_1: bilby.core.prior.Constraint(minimum=10.0, maximum=80.0, name='mass_1')
  mass_2: bilby.core.prior.Constraint(minimum=10.0, maximum=80.0, name='mass_2')
  chirp_mass: bilby.gw.prior.UniformInComponentsChirpMass(minimum=15.0, maximum=100.0, name='chirp_mass')
  mass_ratio: bilby.gw.prior.UniformInComponentsMassRatio(minimum=0.125, maximum=1.0, name='mass_ratio')
  phase: default
  chi_1: bilby.gw.prior.AlignedSpin(name='chi_1', a_prior=Uniform(minimum=0, maximum=0.9))
  chi_2: bilby.gw.prior.AlignedSpin(name='chi_2', a_prior=Uniform(minimum=0, maximum=0.9))
  theta_jn: default
  # Reference values for fixed (extrinsic) parameters. These are needed to generate a waveform.
  luminosity_distance: 100.0  # Mpc
  geocent_time: 0.0  # s

# Dataset size
num_samples: 10000  #for production use arround 5000000

# Save a compressed representation of the dataset
compression:
  svd:
    # Truncate the SVD basis at this size. No truncation if zero.
    size: 200
    num_training_samples: 5000
    num_validation_samples: 1000
  whitening: aLIGO_ZERO_DET_high_P_asd.txt
####################################################################

asd settings updated to 4s like toy model
fiducial asd 6m43s
2nd set error after 10H and 7L 1h3m 
deleted 3 H and started training
not working training broke off after 22m

2nd set all 20 done after 58m
training done after 32m
full inference of GW150914 in 7m30s

check weight plot for importance sampling!
current IS not reliably since few dominating weights

Scaled down modell to weak


17.12.2025

Reworked environment hopefully ASD generation is now faster
fidiucial asd from 6m43s to 2m30s
clean environment really important!!!!



Waveform generation times delta_f=0.25:

num_samples: 50000
num_training_samples: 500
um_validation_samples: 100
34s

num_samples: 10000
num_training_samples: 5000
um_validation_samples: 1000
(old settings) 3m44s
new settings 3m55s

S_data:
num_samples: 500000
num_training_samples: 5000
um_validation_samples: 1000
expected 3h20m
actual 48m37s



S_data asd:
num_pspds_max =250
13h26m 

Training settings as before
14h13m

19.12.2025
Full inference in 7m15s

Toy retraining on GPU Laptop
waveform dataset 10s
asd dataset 2m35s
training 4m6s
inference 2m42

22.12.2025
Performance mode has to be reactivated when restarting PC


